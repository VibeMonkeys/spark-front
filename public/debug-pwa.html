<!DOCTYPE html>
<html>
<head>
    <title>PWA Debug</title>
</head>
<body>
    <h1>PWA ë””ë²„ê¹… í˜ì´ì§€</h1>
    <div id="results"></div>
    
    <script>
        const results = document.getElementById('results');
        
        function log(message, type = 'info') {
            const div = document.createElement('div');
            div.style.margin = '10px 0';
            div.style.padding = '10px';
            div.style.border = '1px solid #ccc';
            div.style.backgroundColor = type === 'error' ? '#ffebee' : '#e8f5e8';
            div.innerHTML = message;
            results.appendChild(div);
        }
        
        // PWA ì§€ì› í™•ì¸
        if ('serviceWorker' in navigator) {
            log('âœ… Service Worker ì§€ì›ë¨');
        } else {
            log('âŒ Service Worker ì§€ì› ì•ˆë¨', 'error');
        }
        
        // ë§¤ë‹ˆí˜ìŠ¤íŠ¸ í™•ì¸
        fetch('/manifest.json')
            .then(response => response.json())
            .then(manifest => {
                log('âœ… Manifest ë¡œë“œë¨: ' + manifest.name);
                log('ğŸ“± ì•„ì´ì½˜ ê°œìˆ˜: ' + manifest.icons.length);
            })
            .catch(err => {
                log('âŒ Manifest ë¡œë“œ ì‹¤íŒ¨: ' + err.message, 'error');
            });
        
        // Service Worker ë“±ë¡ ìƒíƒœ í™•ì¸
        navigator.serviceWorker.getRegistrations().then(registrations => {
            log('ğŸ”§ ë“±ë¡ëœ SW ê°œìˆ˜: ' + registrations.length);
            registrations.forEach((registration, index) => {
                log(`SW ${index + 1}: ${registration.scope}`);
            });
        });
        
        // beforeinstallprompt ì´ë²¤íŠ¸ ê°ì§€
        window.addEventListener('beforeinstallprompt', (e) => {
            log('ğŸ‰ PWA ì„¤ì¹˜ ê°€ëŠ¥! beforeinstallprompt ì´ë²¤íŠ¸ ë°œìƒ');
            
            // ì„¤ì¹˜ ë²„íŠ¼ ìƒì„±
            const installBtn = document.createElement('button');
            installBtn.textContent = 'ì•± ì„¤ì¹˜í•˜ê¸°';
            installBtn.style.padding = '10px 20px';
            installBtn.style.margin = '10px';
            installBtn.style.backgroundColor = '#9333ea';
            installBtn.style.color = 'white';
            installBtn.style.border = 'none';
            installBtn.style.borderRadius = '5px';
            installBtn.onclick = async () => {
                e.prompt();
                const { outcome } = await e.userChoice;
                log('ì„¤ì¹˜ ê²°ê³¼: ' + outcome);
            };
            results.appendChild(installBtn);
        });
        
        // í˜„ì¬ URL ì •ë³´
        log('ğŸŒ í˜„ì¬ URL: ' + window.location.href);
        log('ğŸ”’ HTTPS: ' + (window.location.protocol === 'https:' ? 'ì˜ˆ' : 'ì•„ë‹ˆì˜¤ (localhostëŠ” OK)'));
        
        // User Agent
        log('ğŸ–¥ï¸ ë¸Œë¼ìš°ì €: ' + navigator.userAgent.substring(0, 100) + '...');
        
        // ìŠ¤íƒ ë“œì–¼ë¡  ëª¨ë“œ í™•ì¸
        if (window.matchMedia('(display-mode: standalone)').matches) {
            log('ğŸ“± ì´ë¯¸ PWAë¡œ ì‹¤í–‰ ì¤‘');
        } else {
            log('ğŸŒ ë¸Œë¼ìš°ì €ì—ì„œ ì‹¤í–‰ ì¤‘');
        }
    </script>
</body>
</html>